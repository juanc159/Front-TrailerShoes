import{useCrudRoleStore as I}from"./useCrudRoleStore-badf9d0d.js";import{i as N,s as U,Y as j,r as y,k as K,o as d,c as p,d as s,p as t,C as m,q as _,b as v,B as c,z as M,n as o,L as h,Z as w,$ as L,a as q,a0 as T,y as z,O as $,P as B,H as P,a1 as E,a2 as G,t as H,R as F,a3 as O,T as Y,K as Z}from"./index-c9350ca5.js";const X=N({__name:"Form",setup(J){const n=I(),{formulario:r}=U(n),R=j(),i=y([]),f=y(),V=y(),k=async a=>{var e;n.typeAction=a,await((e=V.value)==null?void 0:e.resetValidation()),i.value=[],a!="back"&&n.keyList++},S=async()=>{var e;const a=await((e=V.value)==null?void 0:e.validate());if(a!=null&&a.valid){const l=await n.fetchSave();l.code===200&&k("list"),l.code===422&&(i.value=l.errors)}},A=a=>{let e=r.value.permissions.findIndex(l=>l===a);console.log(e),e!=-1?(f.value=!1,r.value.permissions.splice(e,1)):r.value.permissions.push(a)},C=()=>{r.value.permissions=[];for(let a=0;a<n.arrayMenus.length;a++)for(let e=0;e<n.arrayMenus[a].permissions.length;e++)n.arrayMenus[a].permissions[e].estado="Inactivo"},D=()=>{if(f.value)C();else{r.value.permissions=[];for(let a=0;a<n.arrayMenus.length;a++)for(let e=0;e<n.arrayMenus[a].permissions.length;e++)r.value.permissions.push(n.arrayMenus[a].permissions[e].id),n.arrayMenus[a].permissions[e].estado="Activo"}};return K(async()=>{C(),await n.fetchDataForm(),n.roleData.id&&(r.value.permissions=[],await n.fetchInfo(n.roleData.id))}),(a,e)=>(d(),p("div",null,[s(c,null,{default:t(()=>[s(m,{cols:"12",class:"d-flex justify-content-end"},{default:t(()=>[s(_,{color:"secondary",onClick:e[0]||(e[0]=l=>k("back"))},{default:t(()=>[v(" Atras ")]),_:1})]),_:1})]),_:1}),s(Z,{ref_key:"formValidation",ref:V,"lazy-validation":""},{default:t(()=>[s(c,null,{default:t(()=>[s(m,{cols:"4"},{default:t(()=>[s(M,{maxlength:"20",rules:[o(h),o(w)(o(r).name,20),o(L)(o(r).name,8)],modelValue:o(r).name,"onUpdate:modelValue":e[1]||(e[1]=l=>o(r).name=l),"error-messages":o(i).name,label:"Nombre",onKeypress:e[2]||(e[2]=l=>o(i).name="")},null,8,["rules","modelValue","error-messages"])]),_:1}),s(m,{cols:"4"},{default:t(()=>[s(M,{rules:[o(h),o(w)(o(r).description,50)],maxlength:"50",modelValue:o(r).description,"onUpdate:modelValue":e[3]||(e[3]=l=>o(r).description=l),"error-messages":o(i).description,label:"DescripciÃ³n",onKeypress:e[4]||(e[4]=l=>o(i).description="")},null,8,["rules","modelValue","error-messages"])]),_:1})]),_:1}),s(c,null,{default:t(()=>[s(m,null,{default:t(()=>[q("span",null,[v("Todos "),s(T,{label:"Todos",modelValue:o(f),"onUpdate:modelValue":e[5]||(e[5]=l=>z(f)?f.value=l:null),onClick:e[6]||(e[6]=l=>D())},null,8,["modelValue"])])]),_:1})]),_:1}),s(c,null,{default:t(()=>[(d(!0),p($,null,B(o(n).arrayMenus,(l,g)=>(d(),p("div",{key:g},[s(m,{cols:"3"},{default:t(()=>[s(P,{width:"215"},{default:t(()=>[s(E,null,{default:t(()=>[s(G,null,{default:t(()=>[v(H(l.title),1)]),_:2},1024),(d(!0),p($,null,B(l.permissions,(u,x)=>(d(),F(O,{key:x},{default:t(()=>[o(R).permissions.includes(u.name)?(d(),F(T,{key:0,id:"check"+g+"-"+x,label:u.description,"true-value":"Activo","false-value":"Inactivo",value:u.estado,modelValue:u.estado,"onUpdate:modelValue":b=>u.estado=b,onClick:b=>A(u.id)},null,8,["id","label","value","modelValue","onUpdate:modelValue","onClick"])):Y("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),s(c,null,{default:t(()=>[s(m,{cols:"12 d-flex justify-content-center"},{default:t(()=>[s(_,{color:"primary",onClick:e[7]||(e[7]=l=>S())},{default:t(()=>[v("Guardar")]),_:1})]),_:1})]),_:1})]),_:1},512)]))}});export{X as _};
