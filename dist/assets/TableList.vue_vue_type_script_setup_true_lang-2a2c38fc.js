import{_ as N}from"./HeaderAlertView.vue_vue_type_script_setup_true_lang-e1c88155.js";import{e as j,u as F,x as L,y,z as U,A as C,B as H,o as M,c as Q,d as e,C as G,h as n,w as a,a as c,m as f,V as p,b as d,D as I,E as J,G as w,H as K,I as q,J as O,K as W,L as b,t as X,S as Y}from"./index-dd53741e.js";import{useCrudSurveyStore as Z}from"./useCrudSurveyStore-07fe3bda.js";import{P as ee}from"./PreloadInterno-a5d99930.js";import{_ as te}from"./ModalAssignEmails.vue_vue_type_script_setup_true_lang-a217e7ab.js";import{V as m}from"./VTooltip-c58f227b.js";import{V as ae}from"./VSpacer-ddef0a47.js";import{V as oe}from"./VPagination-8df84faf.js";import{V as le}from"./VDataTable-d1d16a2f.js";const ne={class:"d-flex"},se={colspan:"4"},ie={style:{width:"100"},class:"d-flex justify-content-center"},re={class:"me-3",style:{width:"80px"}},ce={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},ue={style:{width:"10rem"}},ge=j({__name:"TableList",setup(de){const i=Z(),S=F(),{action:B,modalReportView:fe,surveys:V,totalPage:x,lastPage:D,currentPage:s,totalData:z,loading:P}=L(i),r=y(10),u=y(""),g=y(""),k=y(""),v=async()=>{await i.fetchAll({perPage:r.value,page:s.value,searchQuery:u.value,sort_direction:g.value,sort_field:k.value})},$=[{title:"Nombre",key:"name"},{title:"Fecha inicio",key:"startDate"},{title:"Fecha fin",key:"endDate"},{title:"Acciones",sortable:!1,key:"actions"}];U(async()=>{await v()});const T=async o=>{o.length>0&&(g.value=o[0].order,k.value=o[0].key,await v())};C([u,r],async()=>{s.value=1}),C([s,u,r],async()=>{await v()});const A=H(()=>{const o=V.value.length?(s.value-1)*x.value+1:0,t=V.value.length+(s.value-1)*x.value;return`Mostrando ${o} a ${t} de ${z.value} registros`}),_=async(o,t=null)=>{B.value=t==null?"new":"edit",i.clearFormulario(),i.typeAction=o,t&&o=="form"&&i.fetchInfo(t),t&&o=="report"&&i.fetchInfoReport(t),t&&o=="answer"&&window.open("/SurveyAnswer/"+t+"/"+window.btoa(String(S.user.email)),"_blank")},R=async o=>{Y.fire({title:"¿Desea eliminar el registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No"}).then(async t=>{t.isConfirmed?(await i.fetchDelete(o),await v()):t.isDenied})};return(o,t)=>{const E=N;return M(),Q("div",null,[e(E,{title:"Listado","sub-title":"Encuestas",icon:"mdi-format-list-bulleted"}),e(n(le),{headers:$,items:n(V),"items-per-page":n(r),"onUpdate:sortBy":T},G({"item.actions":a(({item:l})=>[c("div",ne,[e(f,{size:"x-small",color:"error",variant:"text",icon:"",onClick:h=>R(l.value)},{default:a(()=>[e(p,{size:"22",icon:"tabler-trash"}),e(m,{activator:"parent",location:"top"},{default:a(()=>[d(" Borrar ")]),_:1})]),_:2},1032,["onClick"]),e(f,{icon:"",size:"x-small",color:"default",variant:"text",onClick:h=>_("form",l.value)},{default:a(()=>[e(p,{size:"22",icon:"tabler-edit"}),e(m,{activator:"parent",location:"top"},{default:a(()=>[d(" Editar ")]),_:1})]),_:2},1032,["onClick"]),e(te,{obj:l.raw},null,8,["obj"]),e(f,{icon:"",size:"x-small",color:"default",variant:"text",onClick:h=>_("report",l.value)},{default:a(()=>[e(p,{size:"22",icon:"tabler-chart-infographic"}),e(m,{activator:"parent",location:"top"},{default:a(()=>[d(" Reporte ")]),_:1})]),_:2},1032,["onClick"]),e(f,{icon:"",size:"x-small",color:"default",variant:"text",onClick:h=>_("answer",l.value)},{default:a(()=>[e(p,{size:"22",icon:"tabler-check"}),e(m,{activator:"parent",location:"top"},{default:a(()=>[d(" Responder encuesta ")]),_:1})]),_:2},1032,["onClick"])])]),top:a(()=>[e(I,{fluid:"",class:"d-flex flex-wrap py-4 gap-4"},{default:a(()=>[c("div",re,[e(J,{modelValue:n(r),"onUpdate:modelValue":t[0]||(t[0]=l=>w(r)?r.value=l:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),e(ae),c("div",ce,[c("div",ue,[e(K,{modelValue:n(u),"onUpdate:modelValue":t[1]||(t[1]=l=>w(u)?u.value=l:null),placeholder:"Buscar",density:"compact"},null,8,["modelValue"])]),e(m,{text:"Encuesta",location:"top"},{activator:a(({props:l})=>[e(f,q({class:"ms-1",color:"light",rounded:"lg"},l,{onClick:t[2]||(t[2]=h=>_("form"))}),{default:a(()=>[d(" Crear  "),e(p,{size:"large",color:"success",icon:"mdi-plus"})]),_:2},1040)]),_:1})])]),_:1})]),bottom:a(()=>[e(O,{class:"pt-2"},{default:a(()=>[e(W,null,{default:a(()=>[e(b,{lg:"4",cols:"3"},{default:a(()=>[d(X(n(A)),1)]),_:1}),e(b,{lg:"8",cols:"9",class:"d-flex justify-end"},{default:a(()=>[e(oe,{modelValue:n(s),"onUpdate:modelValue":t[3]||(t[3]=l=>w(s)?s.value=l:null),"total-visible":5,size:"small",length:n(D)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:2},[n(P)?{name:"body",fn:a(()=>[c("tr",null,[c("td",se,[c("div",ie,[e(ee)])])])]),key:"0"}:void 0]),1032,["items","items-per-page"])])}}});export{ge as _};
