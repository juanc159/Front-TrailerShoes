import{i as M,s as W,r as m,l as X,o as c,c as V,d as e,p as l,C as s,q as v,b as f,B as i,Q as C,z as b,n as o,L as _,K as h,x as Y,R as z,O as T,P as A,V as U,T as D,a as E,t as Z,S as P}from"./index-c9350ca5.js";import{useCrudFormStore as ee}from"./useCrudFormStore-03c0a364.js";import{V as B}from"./VTooltip-7bf3ee5c.js";import{V as le}from"./VDataTable-1f115dfc.js";const ae={class:"v-data-table__tr"},te=["colspan"],ne=["colspan"],oe=E("b",null,"Esta tipo de input no posee opciones asociadas",-1),ce=M({__name:"Form",setup(se){const k=ee(),{formulario:d}=W(k),x=m([]),O=m(),$=m(),F=m(),S=async n=>{var a;k.typeAction=n,await((a=O.value)==null?void 0:a.resetValidation()),x.value=[],n!="back"&&k.keyList++},R=async()=>{var a;const n=await((a=O.value)==null?void 0:a.validate());if(n!=null&&n.valid){const t=await k.fetchSave();t.code===200&&S("list"),t.code===422&&(x.value=t.errors??[])}},u=m({label:null,type_input:null}),g=m({name:null}),p=m([]),L=m([{value:1,title:"text"},{value:2,title:"select"},{value:3,title:"checkbox"},{value:4,title:"radio"}]),j=async()=>{u.value={label:null,type_input:null}},q=async()=>{var a;const n=await((a=$.value)==null?void 0:a.validate());if(n!=null&&n.valid){if(u.value.type_input!=1&&p.value.length==0)return P.fire("Debe agregar almenos una opción  al input"),!1;const t=L.value.find(r=>r.value==u.value.type_input);d.value.arrayInputs.push({label:u.value.label,type_input:u.value.type_input,type_name:t.title,arrayOptions:[]}),p.value.forEach(r=>{d.value.arrayInputs[d.value.arrayInputs.length-1].arrayOptions.push(r)}),j()}},K=async n=>{d.value.arrayInputs[n].id?d.value.arrayInputs[n].delete="delete":d.value.arrayInputs.splice(n,1)},I=X(()=>d.value.arrayInputs.filter(n=>n.delete!="delete")),w=[{title:"",key:"data-table-expand",sortable:!1},{title:"Label",key:"label",sortable:!1},{title:"Tipo de input",key:"type_name",sortable:!1},{title:"Acciones",key:"actions",sortable:!1}],G=async()=>{var a;const n=await((a=F.value)==null?void 0:a.validate());n!=null&&n.valid&&(p.value.push({name:g.value.name}),g.value={name:null})},Q=async n=>{p.value[n].id?p.value[n].delete="delete":p.value.splice(n,1)},H=async(n,a)=>{I.value[n].arrayOptions[a].id?I.value[n].arrayOptions[a].delete="delete":I.value[n].arrayOptions.splice(a,1)},J=()=>{p.value=[]};return(n,a)=>(c(),V("div",null,[e(i,null,{default:l(()=>[e(s,{cols:"12",class:"d-flex justify-content-end"},{default:l(()=>[e(v,{color:"secondary",onClick:a[0]||(a[0]=t=>S("back"))},{default:l(()=>[f(" Atras ")]),_:1})]),_:1})]),_:1}),e(h,{ref_key:"formValidation",ref:O,"lazy-validation":""},{default:l(()=>[e(i,null,{default:l(()=>[e(s,{cols:"4"},{default:l(()=>[e(C,{class:"mb-1 text-body-2 text-high-emphasis",text:"Nombre"}),e(b,{modelValue:o(d).name,"onUpdate:modelValue":a[1]||(a[1]=t=>o(d).name=t),rules:[o(_)],"error-messages":o(x).name,onKeypress:a[2]||(a[2]=t=>o(x).name="")},null,8,["modelValue","rules","error-messages"])]),_:1})]),_:1})]),_:1},512),e(h,{ref_key:"formInputValidation",ref:$,"lazy-validation":""},{default:l(()=>[e(i,null,{default:l(()=>[e(s,{cols:"4"},{default:l(()=>[e(C,{class:"mb-1 text-body-2 text-high-emphasis",text:"Label"}),e(b,{modelValue:o(u).label,"onUpdate:modelValue":a[3]||(a[3]=t=>o(u).label=t),rules:[o(_)]},null,8,["modelValue","rules"])]),_:1}),e(s,{cols:"4"},{default:l(()=>[e(C,{class:"mb-1 text-body-2 text-high-emphasis",text:"Tipo de input"}),e(Y,{clearable:"",rules:[o(_)],"onUpdate:modelValue":[a[4]||(a[4]=t=>J()),a[5]||(a[5]=t=>o(u).type_input=t)],items:o(L),modelValue:o(u).type_input},null,8,["rules","items","modelValue"])]),_:1}),e(s,{cols:"4",class:"mt-6"},{default:l(()=>[e(v,{onClick:a[6]||(a[6]=t=>q())},{default:l(()=>[f(" Agregar Input ")]),_:1})]),_:1})]),_:1})]),_:1},512),o(u).type_input&&o(u).type_input!=1?(c(),z(h,{key:0,ref_key:"formOptionValidation",ref:F,"lazy-validation":""},{default:l(()=>[e(i,null,{default:l(()=>[e(s,{cols:"4"},{default:l(()=>[e(b,{clearable:"",modelValue:o(g).name,"onUpdate:modelValue":a[7]||(a[7]=t=>o(g).name=t),rules:[o(_)],label:"Opción"},null,8,["modelValue","rules"])]),_:1}),e(s,{cols:"4"},{default:l(()=>[e(v,{onClick:a[8]||(a[8]=t=>G())},{default:l(()=>[f(" Agregar Opción ")]),_:1})]),_:1})]),_:1}),(c(!0),V(T,null,A(o(p),(t,r)=>(c(),z(i,{key:r},{default:l(()=>[e(s,{cols:"4"},{default:l(()=>[e(b,{modelValue:t.name,"onUpdate:modelValue":y=>t.name=y,rules:[o(_)],label:"Opción #"+(r+1)},null,8,["modelValue","onUpdate:modelValue","rules","label"])]),_:2},1024),e(s,{cols:"4"},{default:l(()=>[e(v,{size:"x-small",color:"error",variant:"text",icon:"",onClick:y=>Q(r)},{default:l(()=>[e(U,{size:"22",icon:"tabler-trash"}),e(B,{activator:"parent",location:"top"},{default:l(()=>[f("Borrar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1},512)):D("",!0),e(i,null,{default:l(()=>[e(s,{cols:"12"},{default:l(()=>[e(o(le),{headers:w,items:o(I)},{"item.actions":l(({item:t,index:r})=>[e(v,{size:"x-small",color:"error",variant:"text",icon:"",onClick:y=>K(r)},{default:l(()=>[e(U,{size:"22",icon:"tabler-trash"}),e(B,{activator:"parent",location:"top"},{default:l(()=>[f("Borrar")]),_:1})]),_:2},1032,["onClick"])]),"expanded-row":l(t=>[E("tr",ae,[t.item.raw.arrayOptions.length>0?(c(),V("td",{key:0,colspan:w.length},[(c(!0),V(T,null,A(t.item.raw.arrayOptions,(r,y)=>(c(),z(i,{class:"my-1",key:y},{default:l(()=>[r.delete?D("",!0):(c(),V(T,{key:0},[e(s,{cols:"1"},{default:l(()=>[e(C,null,{default:l(()=>[f("Opción "+Z(y+1)+" : ",1)]),_:2},1024)]),_:2},1024),e(s,{cols:"4"},{default:l(()=>[e(b,{clearable:"",modelValue:r.name,"onUpdate:modelValue":N=>r.name=N,rules:[o(_)]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),e(s,{cols:"4"},{default:l(()=>[e(v,{size:"x-small",color:"error",variant:"text",icon:"",onClick:N=>H(t.index,y)},{default:l(()=>[e(U,{size:"22",icon:"tabler-trash"}),e(B,{activator:"parent",location:"top"},{default:l(()=>[f("Borrar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)],64))]),_:2},1024))),128))],8,te)):(c(),V("td",{key:1,colspan:w.length},[e(i,{class:"my-1"},{default:l(()=>[e(s,{cols:"12"},{default:l(()=>[oe]),_:1})]),_:1})],8,ne))])]),"item.label":l(({item:t})=>[e(i,{class:"my-5"},{default:l(()=>[e(s,{cols:"12"},{default:l(()=>[e(b,{clearable:"",modelValue:t.raw.label,"onUpdate:modelValue":r=>t.raw.label=r,rules:[o(_)]},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]),_:2},1024)]),bottom:l(()=>[]),_:1},8,["items"])]),_:1})]),_:1}),e(i,null,{default:l(()=>[e(s,{cols:"12 d-flex justify-content-center"},{default:l(()=>[e(v,{color:"primary",onClick:a[9]||(a[9]=t=>R())},{default:l(()=>[f("Guardar")]),_:1})]),_:1})]),_:1})]))}});export{ce as _};
