import{_ as P}from"./HeaderAlertView.vue_vue_type_script_setup_true_lang-e1c88155.js";import{e as z,x as G,u as K,y as b,z as L,o as c,c as y,d as s,h as a,w as t,R as j,K as k,L as m,H as I,T as _,a2 as D,a3 as E,b as V,E as H,g as F,a as p,a4 as R,G as q,F as S,P as T,O as x,X as O,a5 as Q,t as X,a6 as J,Q as W,m as Y,I as Z,V as ee,D as ae}from"./index-dd53741e.js";import{useCrudRoleStore as se}from"./useCrudRoleStore-80df9c31.js";import{V as le}from"./VTooltip-c58f227b.js";const te=p("b",{class:"text-warning"},"*",-1),oe=p("b",{class:"text-warning"},"*",-1),ne=p("dt",null,[p("b",{class:"text-vblack fs-6 me-auto"},"Permisos")],-1),me=z({__name:"Form",setup(re){const o=se(),{action:$,formulario:n}=G(o),B=K(),i=b([]),f=b(),v=b(),C=async l=>{var e;o.typeAction=l,await((e=v.value)==null?void 0:e.resetValidation()),i.value=[],l!="back"&&o.keyList++},U=async()=>{var e;const l=await((e=v.value)==null?void 0:e.validate());if(l!=null&&l.valid){const u=await o.fetchSave();u.code===200&&C("list"),u.code===422&&(i.value=u.errors)}},A=l=>{let e=n.value.permissions.findIndex(u=>u===l);console.log(e),e!=-1?(f.value=!1,n.value.permissions.splice(e,1)):n.value.permissions.push(l)},h=()=>{n.value.permissions=[];for(let l=0;l<o.arrayMenus.length;l++)for(let e=0;e<o.arrayMenus[l].permissions.length;e++)o.arrayMenus[l].permissions[e].estado="Inactivo"},N=()=>{if(f.value)h();else{n.value.permissions=[];for(let l=0;l<o.arrayMenus.length;l++)for(let e=0;e<o.arrayMenus[l].permissions.length;e++)n.value.permissions.push(o.arrayMenus[l].permissions[e].id),o.arrayMenus[l].permissions[e].estado="Activo"}};return L(async()=>{h(),await o.fetchDataForm(),o.roleData.id&&(n.value.permissions=[],await o.fetchInfo(o.roleData.id))}),(l,e)=>{const u=P;return c(),y("div",null,[s(u,{"sub-title":"Rol",action:a($),"validate-crud":!0,"btn-back":!0,onChangeScreenBack:C},null,8,["action"]),s(ae,{class:"bg-vwhite",fluid:""},{default:t(()=>[s(j,{ref_key:"formValidation",ref:v,"lazy-validation":""},{default:t(()=>[s(k,{class:"mt-0"},{default:t(()=>[s(m,{cols:"12",md:"6"},{default:t(()=>[s(I,{maxlength:"20",modelValue:a(n).name,"onUpdate:modelValue":e[0]||(e[0]=r=>a(n).name=r),rules:[a(_),a(D)(a(n).name,20),a(E)(a(n).name,8)],"error-messages":a(i).name,onKeypress:e[1]||(e[1]=r=>a(i).name="")},{label:t(()=>[V(" Nombre "),te]),_:1},8,["modelValue","rules","error-messages"])]),_:1}),s(m,{cols:"12",md:"6"},{default:t(()=>[s(I,{modelValue:a(n).description,"onUpdate:modelValue":e[2]||(e[2]=r=>a(n).description=r),rules:[a(_),a(D)(a(n).description,50)],maxlength:"50","error-messages":a(i).description,onKeypress:e[3]||(e[3]=r=>a(i).description="")},{label:t(()=>[V(" Descripción "),oe]),_:1},8,["modelValue","rules","error-messages"])]),_:1}),s(m,{cols:"12",md:"6"},{default:t(()=>[s(H,{items:a(o).arrayMenus,rules:[a(_)],"error-messages":a(i).pageInitial,"onUpdate:modelValue":[e[4]||(e[4]=r=>a(i).pageInitial=""),e[5]||(e[5]=r=>a(n).pageInitial=r)],modelValue:a(n).pageInitial,label:"Pantalla inicial","item-title":"title","item-value":"to"},null,8,["items","rules","error-messages","modelValue"])]),_:1})]),_:1}),s(k,null,{default:t(()=>[s(m,{cols:"12",class:"pb-0"},{default:t(()=>[s(F,{class:"border-opacity-75 mb-3",color:"csecundary",thickness:3}),p("dl",null,[ne,p("dd",null,[s(R,{label:"Todos",modelValue:a(f),"onUpdate:modelValue":e[6]||(e[6]=r=>q(f)?f.value=r:null),onClick:e[7]||(e[7]=r=>N())},null,8,["modelValue"])])])]),_:1}),(c(!0),y(S,null,T(a(o).arrayMenus,(r,g)=>(c(),x(m,{class:"pb-0",cols:"12",sm:"6",md:"4",lg:"3",key:g},{default:t(()=>[s(O,null,{default:t(()=>[s(Q,null,{default:t(()=>[V(X(r.title),1)]),_:2},1024),(c(!0),y(S,null,T(r.permissions,(d,w)=>(c(),x(J,{class:"pt-0 pb-2",key:w},{default:t(()=>[a(B).permissions.includes(d.name)?(c(),x(R,{key:0,id:"check"+g+"-"+w,label:d.description,modelValue:d.estado,"onUpdate:modelValue":M=>d.estado=M,"true-value":"Activo","false-value":"Inactivo",value:d.estado,onClick:M=>A(d.id)},null,8,["id","label","modelValue","onUpdate:modelValue","value","onClick"])):W("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1}),s(F,{class:"border-opacity-75 mt-6 mb-3",color:"csecundary",thickness:3}),s(k,null,{default:t(()=>[s(m,{cols:"12",class:"text-center"},{default:t(()=>[s(le,{text:"Guardar",location:"top"},{activator:t(({props:r})=>[s(Y,Z({class:"ms-1",color:"light",rounded:"lg"},r,{onClick:e[8]||(e[8]=g=>U())}),{default:t(()=>[V(" Guardar  "),s(ee,{size:"large",color:"success",icon:"mdi-content-save-outline"})]),_:2},1040)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})])}}});export{me as _};
