import{k as r,l as s,n as c,u as d,p as l}from"./index-7cf6b37e.js";const n=l(),m=r("useCompaniesStore",{state:()=>({loading:!0,action:"list",typeAction:"list",companyData:{},keyList:0,dataList:[],totalData:0,totalPage:0,currentPage:1,lastPage:0,formulario:{id:null,name:"",image_icon:null,image_logo:null,image_cover:null}}),getters:{},actions:{clearFormulario(){this.formulario={id:null,name:""}},async fetchAll(e){this.loading=!0,await s.post("/company-list",e).then(t=>{this.loading=!1,this.dataList=t.data.dataList,this.totalData=t.data.totalData,this.totalPage=t.data.totalPage,this.currentPage=t.data.currentPage,this.lastPage=t.data.lastPage}).catch(t=>{this.loading=!1,console.log("error",t)})},async fetchSave(){const e=c(),t=d();e.isLoading=!0;const o=new FormData;for(const a in this.formulario)o.append(a,this.formulario[a]);return await s.post("/company-create",o).then(a=>{if(e.isLoading=!1,a.data.code===200){n.toast("Éxito",a.data.message,"success"),t.company=a.data.aCompany,document.title="CMS - "+a.data.aCompany.name;const i=document.querySelector('link[rel="icon"]');i.href=a.data.aCompany.image_icon}else n.toast("Error",a.data.message,"danger");return{message:a.data.message,code:a.data.code,errors:a.data.errors}}).catch(async a=>(e.isLoading=!1,a.response.status===500&&n.toast("Error",a.response.data.message,"danger"),console.log(await a),{errors:a.response.data.errors,code:a.response.data.code,message:a.response.data.message}))},async fetchDelete(e){const t=c();t.isLoading=!0,await s.delete("/charge-delete/"+e).then(o=>{t.isLoading=!1,n.toast("Éxito",o.data.message,"success")}).catch(async o=>{t.isLoading=!1,console.log(await o)})},async fetchInfo(e){const t=c(),o=d();t.isLoading=!0,await s.get(`/company-info/${e}`).then(async a=>{t.isLoading=!1,this.companyData.id=e,o.company=a.data.data,document.title="CMS - "+a.data.data.name;const i=document.querySelector('link[rel="icon"]');i.href=a.data.data.image_icon,this.formulario=await a.data.data}).catch(async a=>{t.isLoading=!1,console.log(await a)})}}});export{m as useCompaniesStore};
