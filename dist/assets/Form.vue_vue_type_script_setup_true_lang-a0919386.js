import{_ as pe}from"./HeaderAlertView.vue_vue_type_script_setup_true_lang-79f7e532.js";import{r as g,H as ne,j as K,bd as Ve,aH as ke,a1 as Ce,y as I,bg as ee,G as W,ah as xe,d as a,m as $,F as L,b7 as we,bh as Se,b4 as se,D as ie,E as re,aA as Ie,aC as Fe,aE as Be,W as Te,b5 as Pe,Z as Re,aI as ze,aL as De,aM as Ee,X as Ae,aw as Ne,aZ as U,a5 as O,$ as E,bi as $e,e as Ue,s as ae,u as He,o as A,c as Le,g as l,w as o,b as R,J as j,a7 as M,a8 as G,h as Oe,V as je,a as F}from"./index-8ab07650.js";import{r as N}from"./validators-e33fb393.js";import{S as te}from"./sweetalert2.all-e795d634.js";import{useCompaniesStore as Me}from"./useCompaniesStore-bfc2e66e.js";import{V as Ge}from"./VForm-fc9213b6.js";import{V as le,a as C}from"./VRow-2de8352d.js";import{b as Ze,g as qe,u as Je,d as oe,h as Ke,i as We,j as Xe,V as Qe}from"./VTextField-a36c9478.js";import{f as Ye}from"./forwardRefs-9d31fcaa.js";import{V as ea}from"./VChip-d09c5ae5.js";import{V as aa}from"./VDivider-1631d3af.js";import{V as ta}from"./VTooltip-489b0134.js";import{V as la}from"./VContainer-c5b930f8.js";function Z(){const e=g(null),d=g(null),t=g(1),f=g(null),i=g([]);function m(){var b;var r=parseInt(event.target.files[0].size/1024);if(r>3e3)return te.fire({icon:"error",title:"Oops...",text:"Debe registrar máximo 3MB",customClass:{container:"my-swal"}}),n(),!1;const c=(b=event.target.files[0].name.split(".").pop())==null?void 0:b.toLowerCase();return i.value.length>0&&!i.value.includes(c)?(te.fire({icon:"error",title:"Oops...",text:`Solo se admite archivos con extensiónes: ${i.value.join(", ")}`,customClass:{container:"my-swal"}}),n(),!1):event.target.files.length===0?(n(),!1):(e.value=event.target.files[0],!0)}ne(e,r=>{if(!(r instanceof File))return;const c=new FileReader;c.readAsDataURL(r),c.addEventListener("load",()=>{d.value=c.result})});function n(){e.value=null,d.value=null,f.value=null,t.value++}return{imageFile:e,imageUrl:d,handleImageSelected:m,key:t,allowedExtensions:i,clearData:n,name:f}}const q=K()({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...Ze({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>Ve(e).every(d=>d!=null&&typeof d=="object")},...qe({clearable:!0})},emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,d){let{attrs:t,emit:f,slots:i}=d;const{t:m}=ke(),n=Ce(e,"modelValue"),{isFocused:r,focus:c,blur:b}=Je(e),y=I(()=>typeof e.showSize!="boolean"?e.showSize:void 0),V=I(()=>(n.value??[]).reduce((s,h)=>{let{size:B=0}=h;return s+B},0)),k=I(()=>ee(V.value,y.value)),x=I(()=>(n.value??[]).map(s=>{const{name:h="",size:B=0}=s;return e.showSize?`${h} (${ee(B,y.value)})`:h})),_=I(()=>{var h;const s=((h=n.value)==null?void 0:h.length)??0;return e.showSize?m(e.counterSizeString,s,k.value):m(e.counterString,s)}),u=g(),p=g(),v=g();function w(){var s;v.value!==document.activeElement&&((s=v.value)==null||s.focus()),r.value||c()}function z(s){X(s)}function ce(s){f("mousedown:control",s)}function X(s){var h;(h=v.value)==null||h.click(),f("click:control",s)}function ue(s){s.stopPropagation(),w(),we(()=>{n.value=[],Se(e["onClick:clear"],s)})}return ne(n,s=>{(!Array.isArray(s)||!s.length)&&v.value&&(v.value.value="")}),W(()=>{const s=!!(i.counter||e.counter),h=!!(s||i.details),[B,de]=xe(t),[{modelValue:va,...me}]=oe.filterProps(e),[fe]=Ke(e);return a(oe,$({ref:u,modelValue:n.value,"onUpdate:modelValue":T=>n.value=T,class:["v-file-input",e.class],style:e.style,"onClick:prepend":z},B,me,{focused:r.value}),{...i,default:T=>{let{id:D,isDisabled:P,isDirty:Q,isReadonly:ve,isValid:ge}=T;return a(We,$({ref:p,"prepend-icon":e.prependIcon,onMousedown:ce,onClick:X,"onClick:clear":ue,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},fe,{id:D.value,active:Q.value||r.value,dirty:Q.value,disabled:P.value,focused:r.value,error:ge.value===!1}),{...i,default:he=>{var Y;let{props:{class:be,...ye}}=he;return a(L,null,[a("input",$({ref:v,type:"file",readonly:ve.value,disabled:P.value,multiple:e.multiple,name:e.name,onClick:S=>{S.stopPropagation(),w()},onChange:S=>{if(!S.target)return;const _e=S.target;n.value=[..._e.files??[]]},onFocus:w,onBlur:b},ye,de),null),a("div",{class:be},[!!((Y=n.value)!=null&&Y.length)&&(i.selection?i.selection({fileNames:x.value,totalBytes:V.value,totalBytesReadable:k.value}):e.chips?x.value.map(S=>a(ea,{key:S,size:"small",color:e.color},{default:()=>[S]})):x.value.join(", "))])])}})},details:h?T=>{var D,P;return a(L,null,[(D=i.details)==null?void 0:D.call(i,T),s&&a(L,null,[a("span",null,null),a(Xe,{active:!!((P=n.value)!=null&&P.length),value:_.value},i.counter)])])}:void 0})}),Ye({},u,p,v)}});const oa=se({text:String,...ie(),...re()},"v-toolbar-title"),H=K()({name:"VToolbarTitle",props:oa(),setup(e,d){let{slots:t}=d;return W(()=>{const f=!!(t.default||t.text||e.text);return a(e.tag,{class:["v-toolbar-title",e.class],style:e.style},{default:()=>{var i;return[f&&a("div",{class:"v-toolbar-title__placeholder"},[t.text?t.text():e.text,(i=t.default)==null?void 0:i.call(t)])]}})}),{}}}),na=[null,"prominent","default","comfortable","compact"],sa=se({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>na.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...Ie(),...ie(),...Fe(),...Be(),...re({tag:"header"}),...Te()},"v-toolbar"),J=K()({name:"VToolbar",props:sa(),setup(e,d){var k;let{slots:t}=d;const{backgroundColorClasses:f,backgroundColorStyles:i}=Pe(Re(e,"color")),{borderClasses:m}=ze(e),{elevationClasses:n}=De(e),{roundedClasses:r}=Ee(e),{themeClasses:c}=Ae(e),b=g(!!(e.extended||(k=t.extension)!=null&&k.call(t))),y=I(()=>parseInt(Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0),10)),V=I(()=>b.value?parseInt(Number(e.extensionHeight)+(e.density==="prominent"?Number(e.extensionHeight):0)-(e.density==="comfortable"?4:0)-(e.density==="compact"?8:0),10):0);return Ne({VBtn:{variant:"text"}}),W(()=>{var p;const x=!!(e.title||t.title),_=!!(t.image||e.image),u=(p=t.extension)==null?void 0:p.call(t);return b.value=!!(e.extended||u),a(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},f.value,m.value,n.value,r.value,c.value,e.class],style:[i.value,e.style]},{default:()=>[_&&a("div",{key:"image",class:"v-toolbar__image"},[t.image?a(O,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},t.image):a(U,{key:"image-img",cover:!0,src:e.image},null)]),a(O,{defaults:{VTabs:{height:E(y.value)}}},{default:()=>{var v,w,z;return[a("div",{class:"v-toolbar__content",style:{height:E(y.value)}},[t.prepend&&a("div",{class:"v-toolbar__prepend"},[(v=t.prepend)==null?void 0:v.call(t)]),x&&a(H,{key:"title",text:e.title},{text:t.title}),(w=t.default)==null?void 0:w.call(t),t.append&&a("div",{class:"v-toolbar__append"},[(z=t.append)==null?void 0:z.call(t)])])]}}),a(O,{defaults:{VTabs:{height:E(V.value)}}},{default:()=>[a($e,null,{default:()=>[b.value&&a("div",{class:"v-toolbar__extension",style:{height:E(V.value)}},[u])]})]})]})}),{contentHeight:y,extensionHeight:V}}}),ia=F("b",{class:"text-warning"},"*",-1),ra=F("b",{class:"text-warning"},"*",-1),ca=F("b",{class:"bg-cprimary px-2",style:{opacity:"0.7"}}," Vista previa ",-1),ua=F("b",{class:"text-warning"},"*",-1),da=F("b",{class:"bg-cprimary px-2",style:{opacity:"0.7"}},"Vista previa",-1),ma=F("b",{class:"text-warning"},"*",-1),fa=F("b",{class:"bg-cprimary px-2",style:{opacity:"0.7"}},"Vista previa",-1),Fa=Ue({__name:"Form",setup(e){const d=Me(),{action:t,formulario:f}=ae(d),i=He(),{company:m}=ae(i),n=g(Z()),r=g(Z()),c=g(Z()),b=["jpg","jpeg","png","gif"];n.value.allowedExtensions=b,r.value.allowedExtensions=b,c.value.allowedExtensions=b;const y=g([]),V=g(),k=async _=>{var u;d.typeAction=_,await((u=V.value)==null?void 0:u.resetValidation()),y.value=[],_!="back"&&d.keyList++},x=async()=>{var u;n.value.imageFile&&(f.value.image_icon=n.value.imageFile),r.value.imageFile&&(f.value.image_logo=r.value.imageFile),c.value.imageFile&&(f.value.image_cover=c.value.imageFile);const _=await((u=V.value)==null?void 0:u.validate());if(_!=null&&_.valid){const p=await d.fetchSave();p.code===200&&k("list"),p.code===422&&(y.value=p.errors??[])}};return(_,u)=>{const p=pe;return A(),Le("div",null,[a(p,{"sub-title":"Cargo",action:l(t),"validate-crud":!0,"btn-back":!0,onChangeScreenBack:k},null,8,["action"]),a(la,{class:"bg-vwhite",fluid:""},{default:o(()=>[a(Ge,{ref_key:"formValidation",ref:V,"lazy-validation":""},{default:o(()=>[a(le,null,{default:o(()=>[a(C,{cols:"12"},{default:o(()=>[a(Qe,{clearable:"",modelValue:l(f).name,"onUpdate:modelValue":u[0]||(u[0]=v=>l(f).name=v),rules:[l(N)],"error-messages":l(y).name,onKeypress:u[1]||(u[1]=v=>l(y).name="")},{label:o(()=>[R(" Nombre "),ia]),_:1},8,["modelValue","rules","error-messages"])]),_:1}),a(C,{cols:"12",md:"6"},{default:o(()=>[(A(),j(q,{accept:"image/*",rules:l(m).image_icon?[]:[l(N)],key:l(n).key,onChangeOnce:l(n).handleImageSelected,"onClick:clear":l(n).clearData},{label:o(()=>[R(" Icono "),ra]),_:1},8,["rules","onChangeOnce","onClick:clear"]))]),_:1}),M(a(C,{cols:"12",md:"6"},{default:o(()=>[a(U,{class:"text-white",height:"200",cover:"",src:l(n).imageUrl??l(m).image_icon},{default:o(()=>[a(J,{color:"rgba(0, 0, 0, 0)",theme:"dark"},{default:o(()=>[a(H,{class:"text-h4"},{default:o(()=>[ca]),_:1})]),_:1})]),_:1},8,["src"])]),_:1},512),[[G,l(n).imageUrl||l(m).image_icon]]),a(C,{cols:"12",md:"6"},{default:o(()=>[(A(),j(q,{accept:"image/*",rules:l(m).image_logo?[]:[l(N)],key:l(r).key,onChangeOnce:l(r).handleImageSelected,"onClick:clear":l(r).clearData},{label:o(()=>[R(" Logo "),ua]),_:1},8,["rules","onChangeOnce","onClick:clear"]))]),_:1}),M(a(C,{cols:"12",md:"6"},{default:o(()=>[a(U,{class:"text-white",height:"200",cover:"",src:l(r).imageUrl??l(m).image_logo},{default:o(()=>[a(J,{color:"rgba(0, 0, 0, 0)",theme:"dark"},{default:o(()=>[a(H,{class:"text-h4"},{default:o(()=>[da]),_:1})]),_:1})]),_:1},8,["src"])]),_:1},512),[[G,l(r).imageUrl||l(m).image_logo]]),a(C,{cols:"12",md:"6"},{default:o(()=>[(A(),j(q,{accept:"image/*",rules:l(m).image_cover?[]:[l(N)],key:l(c).key,onChangeOnce:l(c).handleImageSelected,"onClick:clear":l(c).clearData},{label:o(()=>[R(" Portada "),ma]),_:1},8,["rules","onChangeOnce","onClick:clear"]))]),_:1}),M(a(C,{cols:"12",md:"6"},{default:o(()=>[a(U,{class:"text-white",height:"200",cover:"",src:l(c).imageUrl??l(m).image_cover},{default:o(()=>[a(J,{color:"rgba(0, 0, 0, 0)",theme:"dark"},{default:o(()=>[a(H,{class:"text-h4"},{default:o(()=>[fa]),_:1})]),_:1})]),_:1},8,["src"])]),_:1},512),[[G,l(c).imageUrl||l(m).image_cover]])]),_:1}),a(aa,{class:"border-opacity-75 my-4",color:"csecundary",thickness:3}),a(le,{class:"pt-0"},{default:o(()=>[a(C,{cols:"12",class:"text-center"},{default:o(()=>[a(ta,{text:"Guardar",location:"top"},{activator:o(({props:v})=>[a(Oe,$({class:"ms-1",color:"light",rounded:"lg"},v,{onClick:u[2]||(u[2]=w=>x())}),{default:o(()=>[R(" Guardar "),a(je,{size:"large",color:"success",icon:"mdi-content-save-outline"})]),_:2},1040)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})])}}});export{Fa as _};
