import{u as ee,bh as le,x as te,bi as ae,y as $,bj as ie,bk as K,e as ce,bl as me,bm as fe,bn as pe,bo as ve,z as _e,o as r,c as g,d as t,w as n,L as m,X as A,J as V,h as e,bp as ge,K as y,O as p,Q as k,R as ye,T as C,a as v,F as U,P as B,a4 as be,m as T,b as P,t as G,G as Q,ai as W,S as Ve,aj as ke,bq as we,Z as xe,Y as he,br as Ce,ar as X}from"./index-dd53741e.js";import{P as Z}from"./PreloadInterno-a5d99930.js";import{V as Se}from"./VSpacer-ddef0a47.js";function Te(){const D=ee(),l=le(),{token:f}=te(l),u=ae({id:null,summary:null,start:null,end:null,calendar_type_id:null,link:null,location:null,description:null,user_id:null,guest:null,charges:[],public:null}),M=$([]);return{form:u,errors:M,clearForm:()=>{u.id=null,u.summary=null,u.start=null,u.end=null,u.calendar_type_id=1,u.link=null,u.location=null,u.description=null,u.user_id=null,u.guest=null,u.charges=[],u.public=null},loginGoogle:()=>{if(!f.value){const d="683505111883-dn6k0to7mgfivvlqp60asmhr4arimc9n.apps.googleusercontent.com";ie(i=>{i.accounts.oauth2.initTokenClient({client_id:d,scope:"email profile openid https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/calendar.events",callback:w=>{console.log("Handle the response",w),f.value=w.access_token}}).requestAccessToken()})}},storeEventGoogle:async d=>{d.start={dateTime:new Date(d.start)},d.end={dateTime:new Date(d.end)};let i="https://www.googleapis.com/calendar/v3/calendars/"+D.user.email+"/events",w="post";d.event_google_id&&(w="put",i="https://www.googleapis.com/calendar/v3/calendars/"+D.user.email+"/events/"+d.event_google_id);const c={"Content-Type":"application/json",Authorization:"Bearer "+f.value};return K({method:w,url:i,data:d,headers:c}).then(async N=>N)},deleteEventGoogle:async d=>await K.delete("https://www.googleapis.com/calendar/v3/calendars/"+D.user.email+"/events/"+d,{headers:{Authorization:"Bearer "+f.value,"Content-type":"application/json"}}).then(async i=>i)}}const Pe=v("h3",null,"Selecciona los cargos a quienes invitas al evento",-1),$e={class:"demo-space-x"},Fe={key:1},Ge=v("h3",null,"Usted ha sido invitado a este evento!!",-1),De=v("h3",null,"¿Desea aceptar la invitación?",-1),Ee=v("h3",null,"Aceptaron",-1),Ae=v("h3",null,"No Aceptaron",-1),Ue=v("h3",null,"Faltan por responder",-1),Be=ce({__name:"Index",setup(D){const{form:l,errors:f,clearForm:u,loginGoogle:M,deleteEventGoogle:ne,storeEventGoogle:se}=Te(),E=ee(),O=[{value:1,title:"Público"},{value:0,title:"Privado"}],d=$(),i=le(),{events:w,loading:c,calendarTypes:N,charges:q}=te(i),J=ae({plugins:[me,fe,pe,ve],initialView:"dayGridMonth",headerToolbar:{left:"prev,next,today",center:"title",right:"dayGridMonth,dayGridWeek,listDay"},locale:"es",editable:!0,selectable:!0,weekends:!0,events:[],select:o=>{o.view.calendar.unselect(),I.value="Agregar Evento",z(),l.start=o.startStr+" 00:00:00",l.end=o.endStr+" 00:00:00"},eventClick:o=>{I.value="Modificar Evento",z(),l.id=o.event.id,l.summary=o.event.extendedProps.summary,l.start=o.event.startStr,l.end=o.event.endStr,l.calendar_type_id=o.event.extendedProps.calendar_type_id,l.link=o.event.extendedProps.link,l.public=o.event.extendedProps.public,l.location=o.event.extendedProps.location,l.description=o.event.extendedProps.description,l.charges=o.event.extendedProps.charges,l.user_id=o.event.extendedProps.user_id,l.guest=o.event.extendedProps.guest},displayEventTime:!1}),_=$(!1),x=$(!1),oe=async()=>{Ve.fire({title:"¿Desea eliminar el registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No",customClass:{container:"my-swal"}}).then(async o=>{o.isConfirmed&&(c.value.form=!0,await i.fetchDelete(l.id),c.value.form=!1,_.value=!1,await j())})},re=async(o=!0)=>{var b;const a=await((b=d.value)==null?void 0:b.validate());if(a!=null&&a.valid){c.value.form=!0,JSON.parse(JSON.stringify(l));let S=JSON.parse(JSON.stringify(l));S.user_id=E.user.id,await i.fetchSave(S),c.value.form=!1,_.value=!1,await j()}},z=()=>{c.value.form=!1,u(),_.value=!0},I=$(""),j=async()=>{await i.fetchAll({user_id:E.user.id}),J.events=w.value};_e(async()=>{await j()});const F=$([]),ue=async o=>{var b;F.value=[],x.value=!x.value;const a=await i.fetchGuestsInformation({event_id:l.id,charge_id:o});a.code==200&&(F.value=(b=a.data)==null?void 0:b.guests,console.log(a))},L=async o=>{await i.fetchAnswerInvitation({event_id:l.id,user_id:E.user.id,answer:o}),_.value=!_.value};return(o,a)=>{const b=ke,S=we,R=xe,H=he,de=Ce;return r(),g("div",null,[t(y,null,{default:n(()=>[t(m,{cols:"12"},{default:n(()=>[t(A,null,{default:n(()=>[t(V,null,{default:n(()=>[t(e(ge),{options:J},null,8,["options"])]),_:1})]),_:1})]),_:1})]),_:1}),t(W,{modelValue:e(_),"onUpdate:modelValue":a[14]||(a[14]=s=>Q(_)?_.value=s:null),persistent:"",class:"v-dialog-sm"},{default:n(()=>[e(c).form?k("",!0):(r(),p(b,{key:0,onClick:a[0]||(a[0]=s=>_.value=!e(_))})),e(c).form?(r(),p(A,{key:1},{default:n(()=>[t(V,null,{default:n(()=>[t(Z)]),_:1})]),_:1})):k("",!0),e(c).form?k("",!0):(r(),p(A,{key:2,title:e(I)},{default:n(()=>[t(V,null,{default:n(()=>[t(ye,{ref_key:"formValidation",ref:d,"lazy-validation":""},{default:n(()=>[t(y,null,{default:n(()=>[t(m,{sm:"6",cols:"12"},{default:n(()=>[t(S,{disabled:e(l).guest,modelValue:e(l).summary,"onUpdate:modelValue":a[1]||(a[1]=s=>e(l).summary=s),label:"Título",rules:[e(C)],"error-messages":e(f).summary},null,8,["disabled","modelValue","rules","error-messages"])]),_:1}),t(m,{sm:"6",cols:"12"},{default:n(()=>[t(R,{disabled:e(l).guest,modelValue:e(l).calendar_type_id,"onUpdate:modelValue":a[2]||(a[2]=s=>e(l).calendar_type_id=s),rules:[e(C)],"error-messages":e(f).calendar_type_id,items:e(N),label:"Tipo"},null,8,["disabled","modelValue","rules","error-messages","items"])]),_:1})]),_:1}),t(y,null,{default:n(()=>[t(m,{sm:"6",cols:"12"},{default:n(()=>[t(H,{disabled:e(l).guest,modelValue:e(l).start,"onUpdate:modelValue":a[3]||(a[3]=s=>e(l).start=s),label:"Fecha y hora inicio","error-messages":e(f).start,rules:[e(C)],config:{enableTime:!0,dateFormat:"Y-m-d H:i"}},null,8,["disabled","modelValue","error-messages","rules"])]),_:1}),t(m,{sm:"6",cols:"12"},{default:n(()=>[t(H,{disabled:e(l).guest,modelValue:e(l).end,"onUpdate:modelValue":a[4]||(a[4]=s=>e(l).end=s),label:"Fecha y hora final","error-messages":e(f).end,rules:[e(C)],config:{enableTime:!0,dateFormat:"Y-m-d H:i"}},null,8,["disabled","modelValue","error-messages","rules"])]),_:1})]),_:1}),t(y,null,{default:n(()=>[t(m,{sm:"6",cols:"12"},{default:n(()=>[t(R,{items:O,modelValue:e(l).public,"onUpdate:modelValue":a[5]||(a[5]=s=>e(l).public=s),label:"Publico / Privado"},null,8,["modelValue"])]),_:1})]),_:1}),e(q).length>0?(r(),p(y,{key:0},{default:n(()=>[t(m,null,{default:n(()=>[Pe,v("div",$e,[(r(!0),g(U,null,B(e(q),(s,h)=>(r(),p(be,{disabled:e(l).guest,key:h,modelValue:e(l).charges,"onUpdate:modelValue":a[6]||(a[6]=Y=>e(l).charges=Y),value:s.value},{label:n(()=>[v("div",null,[e(l).id?(r(),p(T,{key:0,variant:"text",onClick:Y=>ue(s.value)},{default:n(()=>[P(G(s.title),1)]),_:2},1032,["onClick"])):(r(),g("span",Fe,G(s.title),1))])]),_:2},1032,["disabled","modelValue","value"]))),128))])]),_:1})]),_:1})):k("",!0),t(y,null,{default:n(()=>[t(m,null,{default:n(()=>[t(S,{disabled:e(l).guest,modelValue:e(l).link,"onUpdate:modelValue":a[7]||(a[7]=s=>e(l).link=s),label:"Link",rules:[e(C)],"error-messages":e(f).link},null,8,["disabled","modelValue","rules","error-messages"])]),_:1})]),_:1}),t(y,null,{default:n(()=>[t(m,null,{default:n(()=>[t(S,{disabled:e(l).guest,modelValue:e(l).location,"onUpdate:modelValue":a[8]||(a[8]=s=>e(l).location=s),label:"Lugar",rules:[e(C)],"error-messages":e(f).location},null,8,["disabled","modelValue","rules","error-messages"])]),_:1})]),_:1}),t(y,null,{default:n(()=>[t(m,null,{default:n(()=>[t(de,{disabled:e(l).guest,modelValue:e(l).description,"onUpdate:modelValue":a[9]||(a[9]=s=>e(l).description=s),label:"Observaciones",rules:[e(C)],"error-messages":e(f).description},null,8,["disabled","modelValue","rules","error-messages"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(l).guest?k("",!0):(r(),p(V,{key:0,class:"d-flex justify-end gap-3 flex-wrap"},{default:n(()=>[e(l).id?(r(),p(T,{key:0,color:"error",variant:"tonal",onClick:a[10]||(a[10]=s=>oe())},{default:n(()=>[P(" Eliminar ")]),_:1})):k("",!0),t(T,{onClick:a[11]||(a[11]=s=>re())},{default:n(()=>[P(" Guardar ")]),_:1})]),_:1})),e(l).guest?(r(),p(V,{key:1,class:"d-flex justify-end gap-3 flex-wrap"},{default:n(()=>[Ge,De,e(l).id?(r(),p(T,{key:0,loading:e(c).answerInvitation,color:"error",variant:"tonal",onClick:a[12]||(a[12]=s=>L(!0))},{default:n(()=>[P(" Si ")]),_:1},8,["loading"])):k("",!0),t(T,{loading:e(c).answerInvitation,onClick:a[13]||(a[13]=s=>L(!1))},{default:n(()=>[P(" No ")]),_:1},8,["loading"])]),_:1})):k("",!0)]),_:1},8,["title"]))]),_:1},8,["modelValue"]),t(W,{modelValue:e(x),"onUpdate:modelValue":a[17]||(a[17]=s=>Q(x)?x.value=s:null)},{default:n(()=>[t(b,{onClick:a[15]||(a[15]=s=>x.value=!1)}),t(A,{title:"Invitados"},{default:n(()=>[e(c).guestsInformation?(r(),p(V,{key:0},{default:n(()=>[t(Z)]),_:1})):(r(),p(V,{key:1},{default:n(()=>[t(y,null,{default:n(()=>[t(m,{cols:"12",sm:"6"},{default:n(()=>[Ee,v("ul",null,[(r(!0),g(U,null,B(e(F)[1],(s,h)=>(r(),g("li",{key:h},G(s.full_name),1))),128))])]),_:1}),t(m,{cols:"12",sm:"6"},{default:n(()=>[Ae,v("ul",null,[(r(!0),g(U,null,B(e(F)[0],(s,h)=>(r(),g("li",{key:h},G(s.full_name),1))),128))])]),_:1}),t(m,{cols:"12",sm:"6"},{default:n(()=>[Ue,v("ul",null,[(r(!0),g(U,null,B(e(F)[""],(s,h)=>(r(),g("li",{key:h},G(s.full_name),1))),128))])]),_:1})]),_:1})]),_:1})),t(V,{class:"d-flex flex-wrap gap-3"},{default:n(()=>[t(Se),t(T,{onClick:a[16]||(a[16]=s=>x.value=!1)},{default:n(()=>[P(" Cerrar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});typeof X=="function"&&X(Be);export{Be as default};
